{% extends "base.html" %}

{% block content %}
<div class="row">
    <form class="input-field col s4" method="POST">
        <div class="col s12">
        </div>
        <div class="row">
            <div class="input-field col s6 select-field">
                <label>Age (years)</label>
                <input name="Age" type="number" required class="validate" id='Age'>
            </div>
            <div class="input-field col s6">
                <select name="ASA" required id="ASA">
                    <option value="" disabled selected>Select ASA</option>
                    <option value="0">1 (No systemic disease)</option>
                    <option value="1">2 (Mild systemic disease)</option>
                    <option value="2">3 (Severe systemic disease)</option>
                    <option value="3">4 (Life-threatening systemic disease)</option>
                    <option value="4">5 (Moribund patient)</option>
                </select>
                <label>ASA grade</label>
            </div>
            <div class="input-field col s6">
                <label>GCS</label>
                <input name="GCS" type="number" required id="GCS">
            </div>
            <div class="input-field col s6">
                <label>Heart rate (BPM)</label>
                <input name="HR" type="number" required id="HR">
            </div>
            <div class="input-field col s12">
                <label>Systolic blood pressure (mmHg)</label>
                <input name="SBP" type="number" required id="SBP">
            </div>
            <div class="input-field col s12">
                <label>White Cell Count (&times;10<sup>9</sup>/L)</label>
                <input name="WCC" type="number" step="0.1" required id="WCC">
            </div>            
            <div class="input-field col s6">
                <label>Sodium (mmol/L)</label>
                <input name="Na" type="number" id="Na" required>
            </div>
            <div class="input-field col s6">
                <label>Potassium (mmol/L)</label>
                <input name="K" type="number" step="0.1" id="K" required>
            </div>
            <div class="input-field col s6">
                <label>Urea (mmol/L)</label>
                <input name="Urea" type="number" step="0.1" id="Urea" required>
            </div>
            <div class="input-field col s6">
                <label>Creatinine (mmol/L)</label>
                <input name="Creat" type="number" id="Creat" required>
            </div>
        </div>
        <div class="row">
            <div class="col s12">
                <b>Lactate and Albumin can be left blank</b>
            </div>
            <div class="input-field col s6">
                <label>Lactate (mmol/L)</label>
                <input name="Lactate" type="number" id="Lactate" step="0.1" >
            </div>
            <div class="input-field col s6">
                <label>Albumin (g/L)</label>
                <input name="Albumin" type="number" id="Albumin" >
            </div>
        </div>
        <div class="row">
            <div class=" switch col s6">
                <h6>Cardiac arrhythmia?</h6>
                <label>
                    No
                    <input name="Sinus" type="checkbox" id="Sinus">
                    <span class="lever"></span>
                    Yes
                </label>
                <p>Excludes sinus tachycardia. Includes rate-controlled AF.</p>
            </div>
            <div class="switch col s6">
                <h6>CT abdo/pelvis performed?</h6>
                <label>
                    No
                    <input name="CT_performed" type="checkbox" id="CT_performed">
                    <span class="lever"></span>
                    Yes
                </label>
            </div>
        </div>
        <div class="row">
            <div class="input-field col s12 select-field">
                <select name="Indication" id="Indication" required>
                    <option value="" disabled selected>Select indication</option>
                    <option value="0">Small bowel obstruction</option>
                    <option value="3">Large bowel obstruction</option>
<!--                    <option value="1">Intestinal obstruction</option>-->
                    <option value="2">Perforation</option>
                    <option value="4">Peritonitis</option>
                    <option value="5">Ischaemia</option>
                    <option value="6">Haemorrhage</option>
                    <option value="7">Colitis</option>
                    <option value="9">Abdominal abscess</option>
                    <option value="10">Anastomotic leak</option>
                    <option value="11">Incarcerated hernia</option>
                    <option value="12">Volvulus</option>
                    <option value="8">Other</option>
                </select>
                <label>Indication for surgery</label>
            </div>
            <div class="input-field col s12 select-field">
                <select name="Cardio" id="Cardio" required class="validate">
                    <option value="" disabled selected>Select cardiac status</option>
                    <option value="0">None</option>
                    <option value="1">Diuretic, digoxin, Rx for angina or hypertension</option>
                    <option value="2">Peripheral oedema, warfarin, borderline cardiomegaly</option>
                    <option value="3">Raised JVP, cardiomegaly</option>
                </select>
                <label>Cardiac status</label>
            </div>
            <div class="input-field col s12 select-field">
                <select name="Resp" id="Resp" required class="validate">
                    <option value="" disabled selected>Select respiratory status</option>
                    <option value="0">None</option>
                    <option value="1">Dyspnoea on exertion, mild COAD</option>
                    <option value="2">Limiting dyspnoea, moderate COAD</option>
                    <option value="3">Dyspnoea at rest, pulmonary fibrosis/consolidation</option>
                </select>
                <label>Respiratory status</label>
            </div>
            <div class="input-field col s12 select-field">
                <select name="Malignancy" id="Malignancy" required class="validate">
                    <option value="" disabled selected>Select malignancy</option>
                    <option value="0">None</option>
                    <option value="1">Primary only</option>
                    <option value="2">Nodal metastasis</option>
                    <option value="3">Distant metastasis</option>
                </select>
                <label>Malignancy</label>
            </div>
            <div class="input-field col s12 select-field">
                <select name="Soiling" id="Soiling" required class="validate">
                    <option value="" disabled selected>Select peritoneal soiling</option>
                    <option value="0">None</option>
                    <option value="1">Serous fluid</option>
                    <option value="2">Local pus</option>
                    <option value="3">Free bowel content, pus or blood</option>
                </select>
                <label>Peritoneal soiling</label>
            </div>
            <button class="btn waves-effect waves-light" type="submit" name="action">Submit
            </button>
        </div>
        
    </form>
    <div class="col s8 ">

        {% if results %}
        <div class="row">
            <h5>ID:</h5> {{results.ID}}
        </div>
        <div class="row">
            <h5>Seed:</h5> {{results.Seed}}
        </div>
        <div class="row">
            <h5>Results:</h5>
            <b>Median Risk:</b> {{"%.2f"|format(results.Summary.Median|float * 100)}}%
            <br>
            <b>95% Confidence Interval</b>  {{"%.2f"|format(results.Summary.LowerPercentile|float* 100) }}% - {{"%.2f"|format(results.Summary.UpperPercentile|float * 100)}}%
            <div id="histogram"></div>
        </div>
        <div class="row">
            <h5>Seed:</h5> {{results.Inputs}}
        </div>
        {% endif%}
        
        
    </div>
</div>
{% endblock %}
